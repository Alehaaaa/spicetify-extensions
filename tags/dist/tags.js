(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e=Object.create,l=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,t=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t)=>{for(var n in t=t||{})s.call(t,n)&&d(e,n,t[n]);if(i)for(var n of i(t))c.call(t,n)&&d(e,n,t[n]);return e},f=(e,t)=>n(e,a(t));p={"external-global-plugin:react"(e,t){t.exports=Spicetify.React}},m=function(){return y||(0,p[r(p)[0]])((y={exports:{}}).exports,y),y.exports}(),e=null!=m?e(t(m)):{};var p,y,m,u,w,v,h,b,x,S,P=((t,n,a,i)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let e of r(n))s.call(t,e)||e===a||l(t,e,{get:()=>n[e],enumerable:!(i=o(n,e))||i.enumerable});return t})(!u&&m&&m.__esModule?e:l(e,"default",{value:m,enumerable:!0}),m),E=Spicetify.ReactDOM.createRoot,O="[Track Tags]";async function C(e){let t=document.querySelector(e);for(;!t;)await new Promise(e=>setTimeout(e,100)),t=document.querySelector(e);return t}async function A(t,n,a,i,l,e){let o,r,s,c,d=!1;var p=t.item;if(!p)return!1;p.isExplicit?(n.style.display="inherit",d=!0):n.style.display="none","true"===(null==(o=p.metadata)?void 0:o["collection.in_collection"])?(i.style.display="inherit",d=!0,i.onclick=async()=>{var l;l={titleText:"Remove from Liked Songs?",descriptionText:"You will not see this song in your Liked Songs.",confirmText:"Delete",cancelText:"Keep"},await new Promise(n=>{let e=document.createElement("div"),t=(e.className="ReactModalPortal",document.body.appendChild(e),E(e)),a=()=>{t.unmount(),e.remove()};var i=f(g({},l),{isOpen:!0,onConfirm:e=>{var t;null!=(t=l.onConfirm)&&t.call(l,e),a(),n(!0)},onClose:e=>{var t;null!=(t=l.onClose)&&t.call(l,e),a(),n(!1)},onOutside:e=>{var t;null!=(t=l.onOutside)&&t.call(l,e),a(),n(!1)}});t.render(P.default.createElement(Spicetify.ReactComponent.ConfirmDialog,i))})&&(Spicetify.Player.setHeart(!1),setTimeout(()=>{L()},200))}):i.style.display="none","true"===(null==(r=p.metadata)?void 0:r.marked_for_download)?(l.style.display="inherit",d=!0):l.style.display="none";var y,m,n=t.context;if(n){var i=n.uri.split(":"),l=i[1];let e;var t=a.querySelector("img");if("user"===l&&"collection"===i[3])e="/collection/tracks",t.src="https://misc.scdn.co/liked-songs/liked-songs-300.png",a.title="Playing from Liked Songs",a.style.display="inherit",d=!0;else if("playlist"===l||"album"===l)try{var u=await Spicetify.Platform.PlaylistAPI.getMetadata(n.uri);null==(c=null==(s=null==u?void 0:u.images)?void 0:s[0])||!c.url||!1===u.canPlay&&u.isSaved&&"DJ"===u.name?a.style.display="none":(e=`/${i[1]}/`+i[2],t.src=u.images[0].url,a.title="Playing from "+u.name,a.style.display="inherit",d=!0)}catch(e){console.warn(O,`Failed to get metadata for ${l} context: `+n.uri,e),a.style.display="none"}else a.style.display="none";i=a,y=e,m=p,y?(i.onclick=()=>Spicetify.Platform.History.push({pathname:y,search:`?uid=${m.uid}&uri=`+m.uri}),i.style.cursor="pointer"):i.style.cursor="default"}else a.style.display="none";return t=d,e.style.display=t?"inherit":"none",d}console.log(O,"extension loaded"),window.operatingSystem=null!=(t=window.operatingSystem)?t:null,(async()=>{for(var e;null==(e=null==(e=Spicetify.Player)?void 0:e.data)||!e.item;)await new Promise(e=>setTimeout(e,100));await 0,null==window.operatingSystem&&(window.operatingSystem=await Spicetify.Platform.operatingSystem)})();var k={},L=async()=>{if(w){var t=w.parentElement||await C(".main-nowPlayingWidget-nowPlaying .main-trackInfo-enhanced"),n=await Spicetify.Platform.PlayerAPI.getState(),a={item:null==(a=n.item)?void 0:a.uri,context:null==(a=n.context)?void 0:a.uri};let e=!1;(e=JSON.stringify(a)===JSON.stringify(k)&&w.isConnected?"none"!==(null==v?void 0:v.style.display)||"none"!==(null==h?void 0:h.style.display)||"none"!==(null==b?void 0:b.style.display)||"none"!==(null==x?void 0:x.style.display):(k=a,await A(n,v,h,b,x,S)))&&t&&!w.isConnected?t.prepend(w):!e&&w.isConnected&&w.remove()}};async function N(){for(;!window.Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));var e;await 0,(w=await(async()=>{await C(".main-nowPlayingWidget-nowPlaying .main-trackInfo-enhanced");var e=document.createElement("div"),t=(e.id="playing-tags",document.createElement("span")),n=(t.dataset.encoreId="text",t.className="e-9640-text encore-text-body-medium encore-internal-color-text-subdued main-trackList-rowBadges",document.createElement("span")),a=(n.className="playing-explicit-tag",n.title=n.ariaLabel="Explicit",n.textContent="E",t.appendChild(n),v=t,(n=document.createElement("span")).className="Wrapper-sm-only Wrapper-small-only",document.createElement("img")),i=(a.setAttribute("width","14"),a.setAttribute("height","14"),a.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag"),n.appendChild(a),h=n,(a=document.createElement("span")).className="Wrapper-sm-only Wrapper-small-only",a.title="Liked song","http://www.w3.org/2000/svg"),l=document.createElementNS(i,"svg"),o=(l.setAttribute("viewBox","0 0 24 24"),l.setAttribute("width","14"),l.setAttribute("height","14"),l.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag","playing-heart-tag"),document.createElementNS(i,"path"));return o.setAttribute("d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"),o.setAttribute("fill","currentColor"),l.appendChild(o),a.appendChild(l),b=a,(o=document.createElement("span")).dataset.encoreId="text",o.className="encore-text encore-text-body-medium encore-internal-color-text-subdued main-trackList-rowBadges",o.title="Available offline",(l=document.createElementNS(i,"svg")).setAttribute("viewBox","0 0 16 16"),l.setAttribute("height","12"),l.dataset.encoreId="icon",l.setAttribute("role","img"),l.setAttribute("aria-hidden","false"),l.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag","playing-downloaded-tag"),(i=document.createElementNS(i,"path")).setAttribute("d","M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-4.75a.75.75 0 0 0-.75.75v5.94L6.055 8.744a.75.75 0 1 0-1.06 1.06L8 12.811l3.005-3.006a.75.75 0 1 0-1.06-1.06L8.75 9.939V4A.75.75 0 0 0 8 3.25z"),l.appendChild(i),o.appendChild(l),x=o,(i=document.createElement("span")).className="e-9640-text encore-text-marginal",i.dataset.encoreId="text",i.style.paddingLeft="2px",i.style.paddingRight="1px",i.textContent="â€¢",[t,n,a,o,S=i].forEach(e=>e.style.display="none"),e.append(t,n,a,o,i),e})())?(Spicetify.Player.addEventListener("songchange",()=>setTimeout(L,1)),"Windows"===window.operatingSystem?Spicetify.Player.dispatchEvent(new Event("songchange")):L(),document.head.appendChild(((e=document.createElement("style")).innerHTML=`
        .main-nowPlayingWidget-nowPlaying:not(#upcomingSongDiv) .main-trackInfo-enhanced {
            align-items: center;
        }
        #playing-tags {
            display: flex;
            gap: 3px;
            min-width: 0;
            align-items: center;
        }
        #playing-tags span {
            display: flex;
            align-items: center;
        }
        .playing-heart-tag { cursor: pointer; }
        .playing-explicit-tag {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            background-color: var(--text-subdued);
            border-radius: 2px;
            color: var(--background-base);
            font-size: 10px;
            font-weight: 600;
            padding-inline: 4px;
            user-select: none;
        }
        .playing-downloaded-tag { fill: #1ed760; }
        .playing-playlist-tag { border-radius: 15%; }
    `,await e))):console.error(O,"Failed to create initial tags structure. Aborting initialization.")}async function T(){await N()}T().catch(e=>console.error(O,"fatal error",e));var j=T;(async()=>{await j()})()})();