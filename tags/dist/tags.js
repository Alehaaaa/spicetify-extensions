(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e=Object.create,l=Object.defineProperty,a=Object.defineProperties,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,t=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,t,a)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t=t||{})s.call(t,a)&&d(e,a,t[a]);if(i)for(var a of i(t))c.call(t,a)&&d(e,a,t[a]);return e},v=(e,t)=>a(e,n(t));p={"external-global-plugin:react"(e,t){t.exports=Spicetify.React}},u=function(){return y||(0,p[r(p)[0]])((y={exports:{}}).exports,y),y.exports}(),e=null!=u?e(t(u)):{};var p,y,u,m,g,f,S,h,x,b=((t,a,n,i)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let e of r(a))s.call(t,e)||e===n||l(t,e,{get:()=>a[e],enumerable:!(i=o(a,e))||i.enumerable});return t})(!m&&u&&u.__esModule?e:l(e,"default",{value:u,enumerable:!0}),u),P=Spicetify.ReactDOM.createRoot;async function C(e){let t=document.querySelector(e);for(;!t;)await new Promise(e=>setTimeout(e,100)),t=document.querySelector(e);return t}function O(e,t){t.style.display=e?"inherit":"none"}async function A(){(await C(".main-nowPlayingWidget-nowPlaying .main-trackInfo-enhanced > .playing-tags")).remove()}async function E(){var e=await C(".main-nowPlayingWidget-nowPlaying .main-trackInfo-enhanced"),t=document.createElement("div"),e=(t.className="playing-tags",e.prepend(t),document.createElement("span")),a=(e.dataset.encoreId="text",e.className="e-9640-text encore-text-body-medium encore-internal-color-text-subdued main-trackList-rowBadges",document.createElement("span")),a=(a.className="playing-explicit-tag",a.title=a.ariaLabel="Explicit",a.textContent="E",e.appendChild(a),document.createElement("span")),n=(a.className="Wrapper-sm-only Wrapper-small-only",document.createElement("img")),n=(n.setAttribute("width","14"),n.setAttribute("height","14"),n.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag"),a.appendChild(n),document.createElement("span")),i=(n.className="Wrapper-sm-only Wrapper-small-only",n.title="Liked song","http://www.w3.org/2000/svg"),l=document.createElementNS(i,"svg"),o=(l.setAttribute("viewBox","0 0 24 24"),l.setAttribute("width","14"),l.setAttribute("height","14"),l.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag","playing-heart-tag"),document.createElementNS(i,"path")),o=(o.setAttribute("d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"),o.setAttribute("fill","currentColor"),l.appendChild(o),n.appendChild(l),document.createElement("span")),l=(o.dataset.encoreId="text",o.className="encore-text encore-text-body-medium encore-internal-color-text-subdued main-trackList-rowBadges",o.title="Available offline",document.createElementNS(i,"svg")),i=(l.setAttribute("viewBox","0 0 16 16"),l.setAttribute("height","12"),l.dataset.encoreId="icon",l.setAttribute("role","img"),l.setAttribute("aria-hidden","false"),l.classList.add("Svg-img-icon-small-textBrightAccent","playing-playlist-tag","playing-downloaded-tag"),document.createElementNS(i,"path")),i=(i.setAttribute("d","M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-4.75a.75.75 0 0 0-.75.75v5.94L6.055 8.744a.75.75 0 1 0-1.06 1.06L8 12.811l3.005-3.006a.75.75 0 1 0-1.06-1.06L8.75 9.939V4A.75.75 0 0 0 8 3.25z"),l.appendChild(i),o.appendChild(l),document.createElement("span"));return i.className="e-9640-text encore-text-marginal",i.dataset.encoreId="text",i.style.paddingLeft="2px",i.style.paddingRight="1px",i.textContent="â€¢",[e,a,n,o,i].forEach(e=>e.style.display="none"),t.append(e,a,n,o,i),{explicitContainerSpan:e,playlistSpan:a,savedTrackSpan:n,downloadedSpan:o,separator:i}}async function k(t,e,a,n,i,o){let l,r,s,c,d=!1;var p=t.item;if(p){p.isExplicit?(d=!0,e.style.display="inherit"):e.style.display="none","true"===(null==(l=p.metadata)?void 0:l["collection.in_collection"])?(d=!0,n.style.display="inherit",n.onclick=async()=>{var l;l={titleText:"Remove from Liked Songs?",descriptionText:"You will not see this song in your Liked Songs.",confirmText:"Delete",cancelText:"Keep"},await new Promise(a=>{let e=document.createElement("div"),t=(e.className="ReactModalPortal",document.body.appendChild(e),P(e)),n=()=>{t.unmount(),e.remove()};var i=v(w({},l),{isOpen:!0,onConfirm:e=>{var t;null!=(t=l.onConfirm)&&t.call(l,e),n(),a(!0)},onClose:e=>{var t;null!=(t=l.onClose)&&t.call(l,e),n(),a(!1)},onOutside:e=>{var t;null!=(t=l.onOutside)&&t.call(l,e),n(),a(!1)}});t.render(b.default.createElement(Spicetify.ReactComponent.ConfirmDialog,i))})&&(Spicetify.Player.setHeart(!1),setTimeout(()=>{k(Spicetify.Platform.PlayerAPI.getState(),e,a,n,i,o)},200))}):n.style.display="none","true"===(null==(r=p.metadata)?void 0:r.marked_for_download)?(d=!0,i.style.display="inherit"):i.style.display="none";var y,u,t=t.context;if(t){var m=t.uri.split(":");m[1],p.uri;let e;var g=a.querySelector("img");if("user"===m[1]&&"collection"===m[3])e="/collection/tracks",g.src="https://misc.scdn.co/liked-songs/liked-songs-300.png",a.title="Playing from Liked Songs",a.style.display="inherit",O(d=!0,o);else try{var f=await Spicetify.Platform.PlaylistAPI.getMetadata(t.uri);null==(c=null==(s=null==f?void 0:f.images)?void 0:s[0])||!c.url||!1===f.canPlay&&f.isSaved&&"DJ"===f.name?a.style.display="none":(e=`/${m[1]}/`+m[2],g.src=f.images[0].url,a.title="Playing from "+f.name,a.style.display="inherit",d=!0)}catch(e){a.style.display="none"}finally{O(d,o),t=a,y=e,u=p,y?(t.onclick=()=>Spicetify.Platform.History.push({pathname:y,search:`?uid=${u.uid}&uri=`+u.uri}),t.style.cursor="pointer"):t.style.cursor="default"}}else a.style.display="none";O(d,o)}}console.log("[Track Tags] extension loaded"),window.operatingSystem=null!=(t=window.operatingSystem)?t:null,(async()=>{for(var e;null==(e=null==(e=Spicetify.Player)?void 0:e.data)||!e.item;)await new Promise(e=>setTimeout(e,100));await 0,null==window.operatingSystem&&(window.operatingSystem=await Spicetify.Platform.operatingSystem)})();var T={};async function L(){for(;!window.Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));await 0;var t=await E();if(t){({explicitContainerSpan:g,playlistSpan:f,savedTrackSpan:S,downloadedSpan:h,separator:x}=t);let e=async()=>{if(!(null!=g&&g.isConnected&&null!=f&&f.isConnected&&null!=S&&S.isConnected&&null!=h&&h.isConnected&&null!=x&&x.isConnected)){console.warn("Tags not connected to DOM. Attempting to re-add."),await A();var e=await E();if(!e)return void console.error("Failed to re-add tags. Cannot update.");({explicitContainerSpan:g,playlistSpan:f,savedTrackSpan:S,downloadedSpan:h,separator:x}=e)}var t,e=await Spicetify.Platform.PlayerAPI.getState();null!=e&&e.context?(t={item:null==(t=e.item)?void 0:t.uri,context:null==(t=e.context)?void 0:t.uri},JSON.stringify(t)!==JSON.stringify(T)&&(T=t,await k(e,g,f,S,h,x))):(await A(),T={})};Spicetify.Player.addEventListener("songchange",()=>setTimeout(e,1)),"Windows"===window.operatingSystem?Spicetify.Player.dispatchEvent(new Event("songchange")):e(),document.head.appendChild(((t=document.createElement("style")).innerHTML=`
		.main-nowPlayingWidget-nowPlaying:not(#upcomingSongDiv) .main-trackInfo-enhanced {
			align-items: center;
		}
		.playing-tags {
			display: flex;
			gap: 3px;
			min-width: 0;
			align-items: center;
		}
		.playing-tags span {
			display: flex;
			align-items: center;
		}
		.playing-heart-tag { cursor: pointer; }
		.playing-explicit-tag {
			display: inline-flex;
			justify-content: center;
			align-items: center;
			background-color: var(--text-subdued);
			border-radius: 2px;
			color: var(--background-base);
			font-size: 10px;
			font-weight: 600;
			padding-inline: 4px;
			user-select: none;
		}
		.playing-downloaded-tag { fill: #1ed760; }
		.playing-playlist-tag { border-radius: 15%; }
	`,await t))}else console.error("Failed to add initial tags. Aborting initialization.")}async function N(){await L()}N().catch(e=>console.error("[Track Tags] fatal error",e));var j=N;(async()=>{await j()})()})();